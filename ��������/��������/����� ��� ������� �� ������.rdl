<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <DataSources>
    <DataSource Name="rc_unact">
      <rd:DataSourceID>9ce029e1-261f-4a9b-88c8-7f43c8603515</rd:DataSourceID>
      <DataSourceReference>rc_unact</DataSourceReference>
    </DataSource>
    <DataSource Name="proxycat">
      <rd:DataSourceID>7f4bd2bb-0366-435c-93db-bc7d47bdeaf8</rd:DataSourceID>
      <DataSourceReference>proxycat</DataSourceReference>
    </DataSource>
  </DataSources>
  <InteractiveHeight>11in</InteractiveHeight>
  <ReportParameters>
    <ReportParameter Name="ddate">
      <DataType>DateTime</DataType>
      <AllowBlank>true</AllowBlank>
      <Prompt>Период</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>period</DataSetName>
          <ValueField>ddate</ValueField>
          <LabelField>name</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="filial">
      <DataType>Integer</DataType>
      <DefaultValue>
        <Values>
          <Value>1</Value>
        </Values>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>Филиал</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>filial</DataSetName>
          <ValueField>id</ValueField>
          <LabelField>name</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="podr">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>0</Value>
        </Values>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>Подразделение</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>podr</DataSetName>
          <ValueField>id</ValueField>
          <LabelField>name</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="super">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>0</Value>
        </Values>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>Супервайзер</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>super</DataSetName>
          <ValueField>id</ValueField>
          <LabelField>name</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="salesman">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>0</Value>
        </Values>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>Торговый представитель</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>salesman</DataSetName>
          <ValueField>id</ValueField>
          <LabelField>name</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="client">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>0</Value>
        </Values>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>Покупатель</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>client</DataSetName>
          <ValueField>id</ValueField>
          <LabelField>name</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
  </ReportParameters>
  <rd:DrawGrid>true</rd:DrawGrid>
  <InteractiveWidth>8.5in</InteractiveWidth>
  <rd:GridSpacing>0.25cm</rd:GridSpacing>
  <rd:SnapToGrid>true</rd:SnapToGrid>
  <RightMargin>1cm</RightMargin>
  <LeftMargin>1cm</LeftMargin>
  <BottomMargin>2.5cm</BottomMargin>
  <rd:ReportID>a2f9f3af-76ab-4b08-b968-fcac1a1a7cfd</rd:ReportID>
  <EmbeddedImages>
    <EmbeddedImage Name="lock_unlocked">
      <MIMEType>image/png</MIMEType>
      <ImageData>iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAdTAAAOpgAAA6lwAAF2+XqZnUAAAAGHRFWHRTb2Z0d2FyZQBQYWludC5ORVQgdjMuMzap5+IlAAAFF0lEQVR4Xu2aIWwWQRSEIUE0QUCCgCBIgyAgSIogqUBUIpHISmQlsg6JRCKRSCQSiUQikUgc8F5Im25T/tm7292b/jObbCre3e6bb97e7l3/K1fcTMAETMAETMAETMAETMAETMAETMAETMAETMAETMAETMAEFhC4E/ceXNB3F4zpW4kJPIzcXkf/HP1X9D+g53Vvou8Ta3JqFQRexjVfKwzfVBDf4/6j6DsV8/kSEgLPI49vC40/XxQ/YrxXJPqcxn8I5N7+qbHx5wshnyi5pbiREchVn6sU7e8t4nmO8NOAqADSjBbGTh3jHRED2VSOVzL/pFhyy/EBcaXyW2L+l8g5X/fO9qlPgJPrP66kX3raOY/990EsXw03rdg8S+SjveZ7wdmC8XYwsBzzFD7FoDQ+3xCmtJtxcX4MmjLP4ZQJfO08Arl6a9/x863gYN40p3dlsdV+TMpi2V04n28HBHJV1uzVaVqu4hYtiy6fIjXz5pnCrROBvUoTep3Ma4vAW0GnAsjTNlqFLVf+RTI+VOSQW49fDRsXQc3q/zlgD649gxw11i8/XM3qH/V5tqYY87+Ibo0I5Csceh0bffh6W7EVvGikX36Y/DEH2vtzVY5sNUXpL4SNHMnPtpsKIONrNPRKmk8tHwYXOpMrDa3+tR61u8S5LcTOc/shgJwn/zVXWZ49NhVonhXcFhBAH18yvmZD55P8LuG2gAD6Dp9PiDVb/q8AbVFrPqHWZLN47gSH4DL8Pi+3oU157i0mIToAWl0JnqGht5T8DYLbDAL544xNK4tlf0X/H8hzgtsMArm/byoAlg8t6HvA
8QztviUIoAJY+w3gxKQjUKj+udjMcka/+2MpgMtSqDNtWO+2BPt7w+rKAri6XnqnM2ehXoY8CVBNS8EFMI3X1l3tAtg6S6cJcgFM47V1V7sAts7SaYJcANN4bd3VLoCts9SCTMAETMAEBhBA/0dXjA/AzjOFosFIM487AzJBMBTjA7DzTKFoMNLM486ATBAMxfgA7DxTKBqMNPO4MyATBEMxPgA7zxSKBiPNPO4MyATBUIwPwM4zhaLBSDOPOwMyQTAU4wOw80yhaDDSzOPOgEwQDMX4AOw8UygajDTzuDMgEwRDMT4AO88UigYjzTzuOBMTMAETMAET6EcA7YeK8X60CUdWNBhpJrSpX0oIhmK8H23CkRUNRpoJbeqXEoKhGO9Hm3BkRYORZkKb+qWEYCjG+9EmHFnRYKSZ0KZ+KSEYivF+tAlHVjQYaSa0qV9KCIZivB9twpEVDUaaCW3qlxKCoRjvR5twZEWDkWZCm/qlhGAoxvvRJhxZ0WCkmdAmp2QCJmACJmACzQmg/VAx3hwy84CKBiPNzH41zw3BUIw3h8w8oKLBSDOzX81zQzAU480hMw+oaDDSzOxX89wQDMV4c8jMAyoajDQz+9U8NwRDMd4cMvOAigYjzcx+Nc8NwVCMN4fMPKCiwUgzs1/Nc0MwFOPNITMPqGgw0szsV/PcEAzFeHPIzAMqGow0M/vl3EygLYFnMdzj6PnX/R8DqbYfat1LBlIF8DTUupcMpArgSah1LxlIFUDu/+4lA6kCeBRq3UsGUgXwINS6lwykCuB+qHUvGUgVwL1Q614ykCqAu6HWvWQgVQC3Q617yUCqAG6FWveSgVQB3Ai17iUDqQK4HmrdSwZSBbATat1LBlIFcC3UupcMpArAYk3ABEzABEzABEzABEzABC4Tgb93BiQaMRetmwAAAABJRU5ErkJggg==</ImageData>
    </EmbeddedImage>
    <EmbeddedImage Name="lock">
      <MIMEType>image/png</MIMEType>
      <ImageData>iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAADQUlEQVR4nO3cIWxTQRzH8R8EURLEFKmsrJxEkDBZCQ5ZOTk5RTI1OYmcRG5uQdWQDFcJbnUNanVFEIp4bUJK6V1f27vr+30/yWVJX7r7t/d79+7eXiYBAAAAAAAAABruSe4CMmlL6q54fTRvaJiupHNJA0lTSbNAG0i6lPQqR7HYnfeShgoP+Lr2IOlMUitx7dhCT9I3bTfwy20s6TTlh8Dm2pLutNuBX25DrV4/ILOeqrN0n4O/aFMxGxTlVGkGfrl9TPHhsN6F8gz+ot3pgBeIh34f4ELSh5rv/Srp59JrJzV/162kdzXfi5rqTPvXqraG687YnqqpPeZ+AZeDTLrabICuVe0QNnGk6mbQJv30638kxGopfo8/Vv1pfaGr+JtJU0mdLftDwKXiBmOo6izehZaqWSSm38GO+sQKx8q7Mo8NQX8PfUPSjdKe+at8iqhhrAPeGpYq5ux/1P6vwbFrkLM912En5uxPdXs2JowPiWqx0FZ4O5Z68XUVqGcm6W3imhrrXOEv+zhxTTGhvElcU2Pda/0XfZ+prtCWdCoWg1trq9yptlNwbY3RV3jln/MsG/ynrkW7ylda2NPcBUR4Ezh+q3//qpfS58DxkxRFNFnoPnw/W2WVrsKXAdYBNbUU/nJLeD7vUWXtUKKVfgnoBI5PJH1PUEdIqIYSQrrSoQdglKCGGKPA8U6CGmopPQChhzhGKYqIMAocf56iiDpKD0DIJHcBcz8Cx18mqaKG0gNwKKvnUBCL/RylByDn/n4TxQ5wSOkBwJ4RAHMEwBwBMEcAzBEAAAA85fz/ALOMfZcq+XiwCDRHAMwRAHMEwBwBMEcAzBEAcwTAHAEwRwDMEQBzBMAcATBHAMwRAAAAPPFIWFl4JAxpEQBzBMAcATBHAMwRAHMEwBwBMEcAzBEAcwTAHAEwRwDMEQBzBAAAAE88ElYWHglD
WgTAHAEwRwDMEQBzBMAcATBHAMwRAHMEwBwBMEcAzBEAcwTAHAEAnOV8IOS1pImko4w1lOZL6g6fpe7wL78kvZj/RCa5A4DMCIA5AmCOAJjLGYDfGfvGHDOAOQJgjgCYIwDmCIA5AmCOAJjjPoA5ZgAAAAAAsPIHfjLsgth+izEAAAAASUVORK5CYII=</ImageData>
    </EmbeddedImage>
  </EmbeddedImages>
  <PageWidth>29.7cm</PageWidth>
  <DataSets>
    <DataSet Name="cat">
      <Fields>
        <Field Name="type">
          <DataField>type</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="isAfter">
          <DataField>isAfter</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="isCond">
          <DataField>isCond</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="bp">
          <DataField>bp</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="cnt_bp">
          <DataField>cnt_bp</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="cnt">
          <DataField>cnt</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="client">
          <DataField>client</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="bp_name">
          <DataField>bp_name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="group_name">
          <DataField>group_name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="goods_set">
          <DataField>goods_set</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ddate">
          <DataField>ddate</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="v0">
          <DataField>v0</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="measure">
          <DataField>measure</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="bonus_measure">
          <DataField>bonus_measure</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="goods">
          <DataField>goods</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="lock_type">
          <DataField>lock_type</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="k_cond">
          <DataField>k_cond</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="k_notcond">
          <DataField>k_notcond</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="v_last_cond">
          <DataField>v_last_cond</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="v_recieve">
          <DataField>v_recieve</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="top_color">
          <DataField>top_color</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="bottom_color">
          <DataField>bottom_color</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="cumulative_sign">
          <DataField>cumulative_sign</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="row_type">
          <DataField>row_type</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="buyer_name">
          <DataField>buyer_name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>proxycat</DataSourceName>
        <CommandText>SET NOCOUNT ON;
SET FMTONLY OFF;

create table #res (
		type int,
		isAfter       int,
		isCond        int,
		bp            int,
		cnt_bp        int,
		cnt           int,
		client        int,
		bp_name       varchar(3000),
		group_name    varchar(255),
		goods_set     varchar(255),			
		ddate         varchar(10),		
		v0            numeric(18,6),
		measure       varchar(10),
		bonus_measure varchar(4),
		goods         varchar(255),
		lock_type     int,
		k_cond        varchar(255),
		k_notcond     varchar(255),
		v_last_cond   numeric(18,6),
		v_recieve     numeric(18,6),
		top_color     int,
		bottom_color  int,
		cumulative_sign varchar(10),
		row_type int,
		buyer_name varchar(255)
)

declare @sql varchar(8000)
declare @fid int

set @sql = '
select
		type,
		isAfter,
		isCond,
		bp,
		cnt_bp,
		cnt,
		client,
		bp_name,
		group_name,
		goods_set,
		ddate,
		v0,
		measure,
		bonus_measure,
		goods,
		lock_type,
		k_cond,
		k_notcond,
		v_last_cond,
		v_recieve,
		top_color,
		bottom_color,
		cumulative_sign,
		row_type,
		buyer_name
from
		dbo.rep_bp2client (''' + @client + ''', ''' + @pgroup + ''', ''' + convert(varchar(10),@ddateb,120) + ''', ''' +convert(varchar(10),@ddatee,120) + ''')'


set @fid = convert(int, @filial)

insert #res (type, isAfter, isCond, bp, cnt_bp, cnt, client, bp_name, group_name, goods_set, ddate, v0, measure, bonus_measure, goods, lock_type, k_cond, k_notcond, v_last_cond, v_recieve, top_color, bottom_color, 
cumulative_sign, row_type, buyer_name)
EXEC get_data_filial @sql, @fid

select type, isAfter, isCond, bp, cnt_bp, cnt, client, bp_name, group_name, goods_set, ddate, v0, measure, bonus_measure, goods, lock_type, k_cond, k_notcond, v_last_cond, v_recieve, top_color, bottom_color, 
cumulative_sign, row_type, buyer_name from #res

drop table #res</CommandText>
        <QueryParameters>
          <QueryParameter Name="@client">
            <Value>=join(Parameters!client.Value,",")</Value>
          </QueryParameter>
          <QueryParameter Name="@ddateb">
            <Value>=Parameters!ddate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@ddatee">
            <Value>=DateAdd(DateInterval.day, -1, DateAdd(DateInterval.month, 1, Parameters!ddate.Value))</Value>
          </QueryParameter>
          <QueryParameter Name="@filial">
            <Value>=Parameters!filial.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@pgroup">
            <Value>=iif(Parameters!salesman.Value = 0, iif(Parameters!super.Value = 0, Parameters!podr.Value, Parameters!super.Value), Parameters!salesman.Value)</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="period">
      <Fields>
        <Field Name="ddate">
          <DataField>ddate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="name">
          <DataField>name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>rc_unact</DataSourceName>
        <CommandText>with border (ddateb, ddatee) as (select min(ddateb), max(ddatee) from bprog)
select distinct
		month1 ddate,
		dbo.get_month_name(month(month1), 1) + ' ' +  convert(char(4),year(month1)) + 'г.' name 
from
		ddates
			join border on ddates.ddate between border.ddateb and border.ddatee</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="client">
      <Fields>
        <Field Name="id">
          <DataField>id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="name">
          <DataField>name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ord">
          <DataField>ord</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>proxycat</DataSourceName>
        <CommandText>SET NOCOUNT ON;
SET FMTONLY OFF;

create table #res (id varchar(255), name varchar(255))

declare @sql varchar(8000)
declare @fid int

set @sql ='select
		b.id,
		left(Rtrim (p.name) + (CASE WHEN p.name &lt;&gt; b.name THEN '' (''+ Rtrim (b.name) + '')'' ELSE '''' END) + '' '' + b.loadto, 80) name
from
		buyers b
			join partners p on p.id = b.partner
			join partners_groups pg on pg.id = p.parent
			join partners_groups_tree pgt on pgt.id = pg.id
where
		    pg.name like ''Актив%''
		and pgt.parent = '+ @pgroup +
		' and b.id in (select client from cnt_result)'

set @fid = convert(int, @filial)

insert #res (id, name)
EXEC get_data_filial @sql, @fid

select id, name, 1 ord from #res 
union
select 0, '&lt;Все покупатели&gt;', 0
order by ord, name

drop table #res</CommandText>
        <QueryParameters>
          <QueryParameter Name="@filial">
            <Value>=Parameters!filial.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@pgroup">
            <Value>=iif(Parameters!salesman.Value = 0, iif(Parameters!super.Value = 0, Parameters!podr.Value, Parameters!super.Value), Parameters!salesman.Value)</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="filial">
      <Fields>
        <Field Name="id">
          <DataField>id</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="name">
          <DataField>name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>proxycat</DataSourceName>
        <CommandText>SELECT
	CAST(filial_status.fid AS VARCHAR(10)) id,
	filial_status.name
FROM
	GRS.GRS.dbo.report report
		JOIN GRS.GRS.dbo.report_filial report_filial ON report_filial.id = report.id
		JOIN GRS.GRS.dbo.filial_status filial_status ON filial_status.fid = report_filial.fid
WHERE
	    report.code = 'nbprogram'</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="podr">
      <Fields>
        <Field Name="id">
          <DataField>id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="name">
          <DataField>name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ord">
          <DataField>ord</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>proxycat</DataSourceName>
        <CommandText>SET NOCOUNT ON;
SET FMTONLY OFF;

create table #res (id varchar(255), name varchar(255))

declare @sql varchar(8000)
declare @fid int

set @sql = 'SELECT 
    partners_groups.id   podr_id,
    partners_groups.name podr_name
FROM 
    pref_concept 
        JOIN prefs ON pref_concept.id = prefs.concept AND pref_concept.type = prefs.type
        JOIN partners_groups ON prefs.id = partners_groups.id
WHERE 
    pref_concept.type = 1 AND 
    pref_concept.name = ''Хр: Партнеры - Подразделение'' AND
    EXISTS
    (
        SELECT 1 
        FROM 
            palm_salesman 
                JOIN partners_groups_tree 
                    ON partners_groups_tree.id = palm_salesman.srv_pgroup 
        WHERE 
            partners_groups_tree.parent = partners_groups.id
    )'

set @fid = convert(int, @filial)

insert #res (id, name)
EXEC get_data_filial @sql, @fid

select id, name, 1 ord from #res
union
select 0, '&lt;Все подразделения&gt;', 0 
order by ord, name

drop table #res</CommandText>
        <QueryParameters>
          <QueryParameter Name="@filial">
            <Value>=Parameters!filial.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="super">
      <Fields>
        <Field Name="id">
          <DataField>id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="name">
          <DataField>name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ord">
          <DataField>ord</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>proxycat</DataSourceName>
        <CommandText>SET NOCOUNT ON;
SET FMTONLY OFF;

create table #res (id varchar(255), name varchar(255))

declare @sql varchar(8000)
declare @fid int

set @sql = 'SELECT 
    partners_groups.id super_id,
    partners_groups.name super_name
FROM 
    pref_concept 
        JOIN prefs ON pref_concept.id = prefs.concept AND pref_concept.type = prefs.type
        JOIN partners_groups ON prefs.id = partners_groups.id
WHERE 
    pref_concept.type = 1 AND 
    pref_concept.name = ''Хр: Партнеры - Менеджеры'' AND
    EXISTS
    (
        SELECT 1 
        FROM 
            palm_salesman 
                JOIN partners_groups_tree 
                    ON partners_groups_tree.id = palm_salesman.srv_pgroup 
        WHERE 
            partners_groups_tree.parent = partners_groups.id
    ) AND
    EXISTS
    (SELECT 1 FROM partners_groups_tree WHERE partners_groups_tree.id = partners_groups.id AND partners_groups_tree.parent = ' + @podr + ')'

set @fid = convert(int, @filial)

insert #res (id, name)
EXEC get_data_filial @sql, @fid

select id, name, 1 ord from #res
union
select 0, '&lt;Все супервайзеры&gt;', 0 
order by ord, name

drop table #res</CommandText>
        <QueryParameters>
          <QueryParameter Name="@filial">
            <Value>=Parameters!filial.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@podr">
            <Value>=Parameters!podr.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="salesman">
      <Fields>
        <Field Name="id">
          <DataField>id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="name">
          <DataField>name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ord">
          <DataField>ord</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>proxycat</DataSourceName>
        <CommandText>SET NOCOUNT ON;
SET FMTONLY OFF;

create table #res (id varchar(255), name varchar(255))

declare @sql varchar(8000)
declare @fid int

set @sql = 'SELECT 
    partners_groups.id salesman_id,
    partners_groups.name salesman_name
FROM 
    pref_concept 
        JOIN prefs ON pref_concept.id = prefs.concept AND pref_concept.type = prefs.type
        JOIN partners_groups ON prefs.id = partners_groups.id
WHERE 
    pref_concept.type = 1 AND 
    pref_concept.name = ''Хр: Партнеры - Торг.предст.'' AND
    EXISTS
    (
        SELECT 1 
        FROM 
            palm_salesman 
                JOIN partners_groups_tree 
                    ON partners_groups_tree.id = palm_salesman.srv_pgroup 
        WHERE 
            partners_groups_tree.parent = partners_groups.id
    ) AND
    EXISTS
    (
        SELECT 1 FROM partners_groups_tree WHERE partners_groups_tree.id = partners_groups.id AND partners_groups_tree.parent = ' + @podr + '
    ) AND
    EXISTS (SELECT 1 FROM partners_groups_tree WHERE partners_groups_tree.id = partners_groups.id AND partners_groups_tree.parent = ' + @super + ')'

set @fid = convert(int, @filial)

insert #res (id, name)
EXEC get_data_filial @sql, @fid

select id, name, 1 ord from #res
union
select 0, '&lt;Все торговые представители&gt;', 0 
order by ord, name

drop table #res</CommandText>
        <QueryParameters>
          <QueryParameter Name="@filial">
            <Value>=Parameters!filial.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@podr">
            <Value>=Parameters!podr.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@super">
            <Value>=Parameters!super.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
  </DataSets>
  <Width>27.012cm</Width>
  <Body>
    <ColumnSpacing>1cm</ColumnSpacing>
    <ReportItems>
      <List Name="list1">
        <DataSetName>cat</DataSetName>
        <KeepTogether>true</KeepTogether>
        <ReportItems>
          <Textbox Name="textbox1">
            <rd:DefaultName>textbox1</rd:DefaultName>
            <Style>
              <Color>SteelBlue</Color>
              <FontFamily>Tahoma</FontFamily>
              <FontSize>14pt</FontSize>
              <FontWeight>700</FontWeight>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
            <ZIndex>1</ZIndex>
            <CanGrow>true</CanGrow>
            <Height>0.75cm</Height>
            <Value>="Отчет для клиента " + Fields!buyer_name.Value + " по акциям за период с " + Format(Parameters!ddate.Value,"dd.MM.yyyy") + " по " + Format(DateAdd(DateInterval.day, -1, DateAdd(DateInterval.month, 1, Parameters!ddate.Value)),"dd.MM.yyyy")</Value>
          </Textbox>
          <Table Name="table1">
            <DataSetName>cat</DataSetName>
            <Top>0.75cm</Top>
            <TableGroups>
              <TableGroup>
                <Grouping Name="group_name">
                  <GroupExpressions>
                    <GroupExpression>=Fields!group_name.Value</GroupExpression>
                  </GroupExpressions>
                </Grouping>
                <Header>
                  <TableRows>
                    <TableRow>
                      <TableCells>
                        <TableCell>
                          <ColSpan>16</ColSpan>
                          <ReportItems>
                            <Textbox Name="textbox2">
                              <rd:DefaultName>textbox2</rd:DefaultName>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>9pt</FontSize>
                                <FontWeight>700</FontWeight>
                              </Style>
                              <ZIndex>16</ZIndex>
                              <CanGrow>true</CanGrow>
                              <Value>=Fields!group_name.Value</Value>
                            </Textbox>
                          </ReportItems>
                        </TableCell>
                      </TableCells>
                      <Height>0.5cm</Height>
                    </TableRow>
                  </TableRows>
                </Header>
              </TableGroup>
            </TableGroups>
            <Details>
              <TableRows>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="bp_name">
                          <rd:DefaultName>bp_name</rd:DefaultName>
                          <HideDuplicates>cat</HideDuplicates>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>Black</Top>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>=iif(Previous(Fields!bp.Value)&lt;&gt;Fields!bp.Value,"Solid","None")</Top>
                              <Bottom>None</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>ru-RU</Language>
                          </Style>
                          <ZIndex>15</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Fields!bp_name.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="goods_set">
                          <rd:DefaultName>goods_set</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <FontWeight>=iif(Fields!type.Value &gt; 0,"Bold","Normal")</FontWeight>
                            <PaddingLeft>=iif(not isNothing(Fields!isAfter.Value) and Fields!isAfter.Value=0, "4pt","0pt")</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>ru-RU</Language>
                          </Style>
                          <ZIndex>14</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Fields!goods_set.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="ddate">
                          <rd:DefaultName>ddate</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>ru-RU</Language>
                          </Style>
                          <ZIndex>13</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Fields!ddate.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="v0">
                          <rd:DefaultName>v0</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <Format>N</Format>
                            <TextAlign>Right</TextAlign>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>ru-RU</Language>
                          </Style>
                          <ZIndex>12</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Replace(Format(Fields!v0.Value, "##0.#"),".",",")</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="k1">
                          <rd:DefaultName>k1</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <Format>N</Format>
                            <TextAlign>Right</TextAlign>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>ru-RU</Language>
                          </Style>
                          <ZIndex>11</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=iif(Fields!type.Value = 0, Fields!k_cond.Value, Nothing)</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="cumulative_sign">
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <Format>N</Format>
                            <TextAlign>Right</TextAlign>
                            <PaddingTop>2pt</PaddingTop>
                          </Style>
                          <ZIndex>10</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=iif(Fields!type.Value = 0, Fields!cumulative_sign.Value, Nothing)</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="measure">
                          <rd:DefaultName>measure</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>ru-RU</Language>
                          </Style>
                          <ZIndex>9</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Fields!measure.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox4">
                          <rd:DefaultName>textbox4</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Webdings</FontFamily>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                          <ZIndex>8</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=iif(Fields!lock_type.Value=1, chr(207), iif(Fields!lock_type.Value=2,chr(208),Nothing))</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox5">
                          <rd:DefaultName>textbox5</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <Format>N</Format>
                            <TextAlign>Right</TextAlign>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>ru-RU</Language>
                          </Style>
                          <ZIndex>7</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=iif((Fields!row_type.Value=1 and Fields!isCond.Value=0) or Fields!row_type.Value=4 or Fields!type.Value=3 or Fields!type.Value=2,Replace(Format(Fields!v_last_cond.Value, "##0.##"),".",","),Nothing)</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox7">
                          <rd:DefaultName>textbox7</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <PaddingTop>2pt</PaddingTop>
                          </Style>
                          <ZIndex>6</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=iif((Fields!row_type.Value=1 and Fields!isCond.Value=0) or Fields!row_type.Value=4 or Fields!type.Value=3,"*",Nothing)</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox6">
                          <rd:DefaultName>textbox6</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <PaddingTop>2pt</PaddingTop>
                          </Style>
                          <ZIndex>5</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=iif((Fields!row_type.Value=1 and Fields!isCond.Value=0) or Fields!row_type.Value=4 or Fields!type.Value=3,Replace(Fields!k_notcond.Value,".",",")+ " " + Fields!bonus_measure.Value,Nothing)</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox8">
                          <rd:DefaultName>textbox8</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <PaddingTop>2pt</PaddingTop>
                          </Style>
                          <ZIndex>4</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=iif((Fields!row_type.Value=1 and Fields!isCond.Value=0) or Fields!row_type.Value=4 or Fields!type.Value=3," = ",Nothing)</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox15">
                          <rd:DefaultName>textbox15</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <Format>N</Format>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>ru-RU</Language>
                          </Style>
                          <ZIndex>3</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Replace(Format(Fields!v_recieve.Value, "##0.##"),".",",")</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox16">
                          <rd:DefaultName>textbox16</rd:DefaultName>
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <PaddingTop>2pt</PaddingTop>
                          </Style>
                          <ZIndex>2</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Fields!bonus_measure.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="goods">
                          <Style>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <PaddingTop>2pt</PaddingTop>
                          </Style>
                          <ZIndex>1</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>=Fields!goods.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox_buyers_name">
                          <Style>
                            <Color>White</Color>
                            <BorderColor>
                              <Default>LightGrey</Default>
                              <Top>=iif(Fields!top_color.Value=1,"Black","LightGrey")</Top>
                              <Bottom>=iif(Fields!bottom_color.Value=1,"Black","LightGrey")</Bottom>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>8pt</FontSize>
                            <PaddingTop>2pt</PaddingTop>
                          </Style>
                          <Value>=Fields!buyer_name.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>0.53333cm</Height>
                </TableRow>
              </TableRows>
            </Details>
            <Style>
              <BorderStyle>
                <Left>Solid</Left>
                <Right>Solid</Right>
                <Top>Solid</Top>
                <Bottom>Solid</Bottom>
              </BorderStyle>
            </Style>
            <Header>
              <TableRows>
                <TableRow>
                  <TableCells>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox9">
                          <rd:DefaultName>textbox9</rd:DefaultName>
                          <Style>
                            <Color>White</Color>
                            <BackgroundColor>SteelBlue</BackgroundColor>
                            <BorderColor>
                              <Default>LightGrey</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                          <ZIndex>23</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Название</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox10">
                          <rd:DefaultName>textbox10</rd:DefaultName>
                          <Style>
                            <Color>White</Color>
                            <BackgroundColor>SteelBlue</BackgroundColor>
                            <BorderColor>
                              <Default>LightGrey</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                          <ZIndex>22</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Множество</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox11">
                          <rd:DefaultName>textbox11</rd:DefaultName>
                          <Style>
                            <Color>White</Color>
                            <BackgroundColor>SteelBlue</BackgroundColor>
                            <BorderColor>
                              <Default>LightGrey</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                          <ZIndex>21</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Период начисления</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox12">
                          <rd:DefaultName>textbox12</rd:DefaultName>
                          <Style>
                            <Color>White</Color>
                            <BackgroundColor>SteelBlue</BackgroundColor>
                            <BorderColor>
                              <Default>LightGrey</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                          <ZIndex>20</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Купил</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ColSpan>2</ColSpan>
                      <ReportItems>
                        <Textbox Name="textbox13">
                          <rd:DefaultName>textbox13</rd:DefaultName>
                          <Style>
                            <Color>White</Color>
                            <BackgroundColor>SteelBlue</BackgroundColor>
                            <BorderColor>
                              <Default>LightGrey</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                          <ZIndex>19</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Условия для бонуса</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox14">
                          <rd:DefaultName>textbox14</rd:DefaultName>
                          <Style>
                            <Color>White</Color>
                            <BackgroundColor>SteelBlue</BackgroundColor>
                            <BorderColor>
                              <Default>LightGrey</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                          <ZIndex>18</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>Ед. изм.</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ColSpan>9</ColSpan>
                      <ReportItems>
                        <Textbox Name="textbox3">
                          <rd:DefaultName>textbox3</rd:DefaultName>
                          <Style>
                            <Color>White</Color>
                            <BackgroundColor>SteelBlue</BackgroundColor>
                            <BorderColor>
                              <Default>LightGrey</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Left>Solid</Left>
                              <Right>Solid</Right>
                              <Top>Solid</Top>
                            </BorderStyle>
                            <FontFamily>Tahoma</FontFamily>
                            <FontSize>9pt</FontSize>
                            <FontWeight>700</FontWeight>
                            <TextAlign>Center</TextAlign>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                          <ZIndex>17</ZIndex>
                          <CanGrow>true</CanGrow>
                          <Value>К получению</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                  <Height>1.25cm</Height>
                </TableRow>
              </TableRows>
              <RepeatOnNewPage>true</RepeatOnNewPage>
            </Header>
            <TableColumns>
              <TableColumn>
                <Width>2.94342cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>3.43399cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>2.20756cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>1.22642cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>1.71699cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.73585cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>1.47171cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.49057cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.98114cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.49057cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>1.98824cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.49057cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.98114cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.98114cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>6.62269cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.25cm</Width>
              </TableColumn>
            </TableColumns>
          </Table>
        </ReportItems>
        <Grouping Name="list1_Details_Group">
          <Label>=Fields!buyer_name.Value</Label>
          <GroupExpressions>
            <GroupExpression>=Fields!buyer_name.Value</GroupExpression>
          </GroupExpressions>
          <PageBreakAtEnd>true</PageBreakAtEnd>
        </Grouping>
      </List>
    </ReportItems>
    <Height>3.03333cm</Height>
  </Body>
  <Language>en-US</Language>
  <TopMargin>2.5cm</TopMargin>
  <PageHeight>21cm</PageHeight>
</Report>